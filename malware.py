#!/usr/bin/env python3

'''
[The author - MiamiHacker] assumes no responsibility or liability for 
any errors or omissions of this script. There is no guarantees of 
completeness, accuracy, usefulness or timeliness.

It's allowed to clone or use parts of the code for your own project but
please keep in mind that is not allowed to use it against other people or
run it on computers that not belongs to you.
Use it on your own system for testing proposal only!!

This is only for educational purpose on a Academic level for basic research
with publication and dissemination to the public. The resource represents an
academic and non-profit organization.
''' 

from operator import index
import colorama
from colorama import Fore
import os
import sys

## version and info to user 

print("───────█████████████████████")
print("────████▀─────────────────▀████")
print("──███▀──────Malware V0.1─────▀███")
print("─██▀───────────────────────────▀██")
print("█▀──────────────by───────────────▀█")
print("█─────────────────────────────────█")
print("█───────────MiamiHacker───────────█")
print("█─────────────────────────────────█")
print("█───█████─────────────────█████───█")
print("█──██▓▓▓███─────────────███▓▓▓██──█")
print("█──██▓▓▓▓▓██───────────██▓▓▓▓▓██──█")
print("█──██▓▓▓▓▓▓██─────────██▓▓▓▓▓▓██──█")
print("█▄──████▓▓▓▓██───────██▓▓▓▓████──▄█")
print("▀█▄───▀███▓▓▓██─────██▓▓▓███▀───▄█▀")
print("──█▄────▀█████▀─────▀█████▀────▄█")
print("─▄██───────────▄█─█▄───────────██▄")
print("─███───────────██─██───────────███")
print("─███───────────────────────────███")
print("──▀██──██▀██──█──█──█──██▀██──██▀")
print("───▀████▀─██──█──█──█──██─▀████▀")
print("────▀██▀──██──█──█──█──██──▀██▀")
print("──────────██──█──█──█──██")
print("──────────██──█──█──█──██")
print("──────────██──█──█──█──██")
print("──────────██──█──█──█──██")
print("──────────██──█──█──█──██")
print("──────────██──█──█──█──██")
print("──────────██──█──█──█──██")
print("──────────██──█──█──█──██")
print("───────────█▄▄█▄▄█▄▄█▄▄█\n")

'''
    For the path in dirName = (r"/") to scan all files 
    in the directories and subdirectories. 
'''
#question if user wants to scan the system
def infectQuestion():
    i = 0
    while i < 2:
        answer = input("Do you wanna scan your system? (yes or no)")
        if any(answer.lower() == f for f in ["yes", 'y', '1', 'ye']):
            print("\nThe following files have been found:")
            break
        elif any(answer.lower() == f for f in ['no', 'n', '0', '']):
            print("Program closed.")
            sys.exit()
        else:
            i += 1
            if i < 2:
                print('Please enter yes or no')
            else:
                print("Program closed incorrect input.")
                sys.exit()
infectQuestion()


def listFiles(dirName):
    # create a list of all files in (sub)directories 
    # filenames in the given directory 
    listOfFile = os.listdir(dirName)
    allFiles = list()
    # Iterate over the entries
    for entry in listOfFile:
        # full path
        fullPath = os.path.join(dirName, entry)
        # If entry is directory get the list of files in it 
        if os.path.isdir(fullPath):
            allFiles = allFiles + listFiles(fullPath)
        else:
            allFiles.append(fullPath)
    return allFiles      

def scan():
    exclude = "malware.py" 
    #set the directory in dirName
    #dirName = (r"/home")
    
    # Get the list of all files in dir at given path
    listOfFiles = list()
    
    for (dirpath, dirnames, filenames) in os.walk(dirName):
            listOfFiles += [os.path.join(dirpath, file) for file in filenames]
        
    # Print the files    
    for elem in listOfFiles:

            if os.path.isfile(elem):
                for listOfFiles in os.listdir():
                    if listOfFiles == exclude:
                       print("malware.py is in path:")
                    continue
                print(Fore.WHITE + 'Founded: ' + Fore.GREEN, elem + Fore.RESET)     
        
if __name__ == '__main__':
    scan()

